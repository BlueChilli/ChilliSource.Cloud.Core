using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Xunit;

namespace ChilliSource.Cloud.Core.Tests
{
    public class GooglePlaceDetailTests
    {
        private const string Json = "{\"html_attributions\":[],\"result\":{\"address_components\":[{\"long_name\":\"13\",\"short_name\":\"13\",\"types\":[\"street_number\"]},{\"long_name\":\"Ventura Road\",\"short_name\":\"Ventura Rd\",\"types\":[\"route\"]},{\"long_name\":\"Northmead\",\"short_name\":\"Northmead\",\"types\":[\"locality\",\"political\"]},{\"long_name\":\"City of Parramatta Council\",\"short_name\":\"City of Parramatta Council\",\"types\":[\"administrative_area_level_2\",\"political\"]},{\"long_name\":\"New South Wales\",\"short_name\":\"NSW\",\"types\":[\"administrative_area_level_1\",\"political\"]},{\"long_name\":\"Australia\",\"short_name\":\"AU\",\"types\":[\"country\",\"political\"]},{\"long_name\":\"2152\",\"short_name\":\"2152\",\"types\":[\"postal_code\"]}],\"adr_address\":\"<span class=\\\"street-address\\\">13 Ventura Rd</span>, <span class=\\\"locality\\\">Northmead</span> <span class=\\\"region\\\">NSW</span> <span class=\\\"postal-code\\\">2152</span>, <span class=\\\"country-name\\\">Australia</span>\",\"formatted_address\":\"13 Ventura Rd, Northmead NSW 2152, Australia\",\"formatted_phone_number\":\"(02) 9639 8038\",\"geometry\":{\"location\":{\"lat\":-33.7721197,\"lng\":151.001497},\"viewport\":{\"northeast\":{\"lat\":-33.7706763197085,\"lng\":151.0028468802915},\"southwest\":{\"lat\":-33.7733742802915,\"lng\":151.0001489197085}}},\"icon\":\"https://maps.gstatic.com/mapfiles/place_api/icons/v1/png_71/cafe-71.png\",\"international_phone_number\":\"+61 2 9639 8038\",\"name\":\"Cafe On Ventura\",\"opening_hours\":{\"open_now\":false,\"periods\":[{\"close\":{\"day\":0,\"time\":\"1300\"},\"open\":{\"day\":0,\"time\":\"0800\"}},{\"close\":{\"day\":1,\"time\":\"1300\"},\"open\":{\"day\":1,\"time\":\"0700\"}},{\"close\":{\"day\":2,\"time\":\"1300\"},\"open\":{\"day\":2,\"time\":\"0700\"}},{\"close\":{\"day\":3,\"time\":\"1300\"},\"open\":{\"day\":3,\"time\":\"0700\"}},{\"close\":{\"day\":4,\"time\":\"1300\"},\"open\":{\"day\":4,\"time\":\"0700\"}},{\"close\":{\"day\":5,\"time\":\"1300\"},\"open\":{\"day\":5,\"time\":\"0700\"}},{\"close\":{\"day\":6,\"time\":\"1400\"},\"open\":{\"day\":6,\"time\":\"0700\"}}],\"weekday_text\":[\"Monday: 7:00 AM – 1:00 PM\",\"Tuesday: 7:00 AM – 1:00 PM\",\"Wednesday: 7:00 AM – 1:00 PM\",\"Thursday: 7:00 AM – 1:00 PM\",\"Friday: 7:00 AM – 1:00 PM\",\"Saturday: 7:00 AM – 2:00 PM\",\"Sunday: 8:00 AM – 1:00 PM\"]},\"photos\":[{\"height\":3024,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/118146934669659641826\\\">Jamie Doyle</a>\"],\"photo_reference\":\"AeJbb3dl7OYTN78lH_BYr1iNtOnklgswDxd6i564dRCrHOYEDG8khENNyyYpXOKRUsT1MSYhpCnYf1pg_mD2BVSaV8GIv5Q5Bo3Lw_oBt_-E09LGbNhuPavaTJziA6DRtuyI6eqFNWQmQ2iHc8bFU6nJf2gqTk8edz6hYqTs-LKbTii88qRz\",\"width\":4032},{\"height\":3456,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/117096559102941121657\\\">Joe Nathan</a>\"],\"photo_reference\":\"AeJbb3djVZayynRY0Th9HKn__KwAcgBOjEK-CuLPz5a5FkpCtySBt6WgdS8uPPj9AhsCTOy5AjBzqiNKRe7eUwsgY_ZjQHxm9jlM0-X5CfAM9M303Qusx0TUrMzOqfWPvc8v7LTNduANC_Zyl9zkcvTYsJCV0xlN0GQgzwGhg_a9BCbqEmkU\",\"width\":4608},{\"height\":3024,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/108433556693240578503\\\">Keegan Thomson</a>\"],\"photo_reference\":\"AeJbb3do7YIYlKHx_OxrtBJMBeOMg5IrlsArZ7HCYmzdpqiSBE3FT81i-V0TyPIYz762S8il7g-JFI8MAx1eahi4KypbsTsh0KtXqGhFFn1SINNAZZROzanuzZyONh4W8G1neVvDpDe03rtzQPt5sO6YiwpOB3i6QryZSXfszu5r1f7E0ODM\",\"width\":4032},{\"height\":3024,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/100346891358848559923\\\">Chris St Clair</a>\"],\"photo_reference\":\"AeJbb3c0VXhK4oUMCn_zHIA84kROC9-Z7ePIljVSLe0CIsYPHhWund7vyTfe0hStf2sdDkhSOJRbzb62VabYyBQe_9jUhSU6azV89S6r8bhHwzz2ht7SM50QatMfM2ZaXk2rpb07t86PDtXDX9A5BmDrxUABWMEoJBxEBsrsJmhI5DEcub1J\",\"width\":4032},{\"height\":4032,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/108433556693240578503\\\">Keegan Thomson</a>\"],\"photo_reference\":\"AeJbb3e130_Pc1BjG3uafMCVf1i2udZ7HOXNOklgxvtuYv0HrR0GiKTQp5tGkiWqtjlaYlHLWix4fcslKJI5R6DPa1IPB7azm9FY59WAkN8mOyQjuyaGMd-GN-WB21cNfsDE8wXHLVFmboWVVdHHtuaVdMbomLevqnFQ3DjQJP9mn9G9YC2X\",\"width\":3024},{\"height\":1277,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/104796846286121131908\\\">Ester M</a>\"],\"photo_reference\":\"AeJbb3fnCTsJ7DxZUAIw3zTkio_6wZ5meQPnZvt7rCj5zoF_-bee9UNa09PqzgGwy732h76on23duNCxWWnWh0tE365tJjuAlQrjbaxkjDDw3B7ZSvAysg7Q8NJb3WgUVrsD7MR3ECIncrUjX_wlMqDcjny4nRtRwqc3NX_GTvLFmk0aYLsv\",\"width\":1222},{\"height\":979,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/104796846286121131908\\\">Ester M</a>\"],\"photo_reference\":\"AeJbb3cs66CfSwsSKWL-vcYY3Ejj6O9zHmYgA-Va4x1u3ffk-9nba5TCV8BvcYP3_3YclmIEmsiNxF9Fz7OnHlr6UBjVrB2yxrasxXBNCw_6GHFJ2gvki0gNRRH4tvqFitMMkbkOKiDsRFEm8ZSy2AZHAvqZFXj_T9xO3uq-rpGdNEpjbCDU\",\"width\":1477},{\"height\":3120,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/113220143599279200397\\\">kapil arora</a>\"],\"photo_reference\":\"AeJbb3c0Sg7YZSyxVI4edrlTtL5ZfeQhPQ0ej0uRrL7vDZGgReNxouG05BVONh54Sn6RT5Y1QjYgxSvA7pwl93_lQvsMnEJzJzN7ZZ_8SwfXYfHpcCsh5MKAs0Ey9RTSlnZ4Ja4M7l9Jfa7HMMP4CmVhrfzQUvYMSqu8KtMuKX5xRt2zMEqH\",\"width\":4160},{\"height\":3120,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/113220143599279200397\\\">kapil arora</a>\"],\"photo_reference\":\"AeJbb3dXKAjmReI0Vw6URYu8VdkyGyowNN0S885-zbCIvNgwn30uacXB24PXLNM3UWYyYeo3B7MaHVx1bKiuehpwO5hmjYjrGB5ZRFAeniENjq5AgMZwLBgjL2sCUbktGOSbKHlpxcGJuaybcTbHwWB7pwW3SyZAlvn24RnRBvwBmmC231O3\",\"width\":4160},{\"height\":4032,\"html_attributions\":[\"<a href=\\\"https://maps.google.com/maps/contrib/103631002415920378676\\\">Keira Gahagan</a>\"],\"photo_reference\":\"AeJbb3cdKHfPkhkqh2ixR5E4JD1u8uxfRBj3fRFMlXppyFjBCMpglmYCkQZ7ASMmhQ34r3atf6ethE04bzJls0leBGv1jLPYmCP8tKLdygwDl7KuXPcZuwCM2Z-S9xE2MoZur54JravUcfnHb6hG2bLGad9TUmr-y9NVTBZatQoet5ySgkr2\",\"width\":3024}],\"place_id\":\"ChIJRdfXJsujEmsR9MhrFiVPN6g\",\"plus_code\":{\"compound_code\":\"62H2+5H Northmead NSW, Australia\",\"global_code\":\"4RRH62H2+5H\"},\"price_level\":1,\"rating\":4.4,\"reviews\":[{\"author_name\":\"Keegan Thomson\",\"author_url\":\"https://www.google.com/maps/contrib/108433556693240578503/reviews\",\"language\":\"en\",\"profile_photo_url\":\"https://lh3.googleusercontent.com/a-/AFdZucoaPL0y6c1Sp2PXRy6vfQCH9IxGtuozncLrOVctNw=s128-c0x00000000-cc-rp-mo-ba5\",\"rating\":5,\"relative_time_description\":\"2 months ago\",\"text\":\"One of the best little cafes around! Great outdoor seating, a delicious and delightful menu and some super lovely and warm staff! Compared to some of the other cafes around this is some of the best value food and coffee around.\n\nYou’ll be able to do take away and sit in the park next to the cafe as well if you need some green bathing!\",\"time\":1651884575},{\"author_name\":\"Brendan\",\"author_url\":\"https://www.google.com/maps/contrib/114240812146591020663/reviews\",\"language\":\"en\",\"profile_photo_url\":\"https://lh3.googleusercontent.com/a-/AFdZucrBdRLxalCh9erY6vOqgl0k_HKZiY1m-xDqo2SySQ=s128-c0x00000000-cc-rp-mo-ba4\",\"rating\":5,\"relative_time_description\":\"a month ago\",\"text\":\"Good bacon and egg roll and coffee. Roll had spinach too which was a great addition. Fast and friendly service.\",\"time\":1652693892},{\"author_name\":\"Gavin Fisher\",\"author_url\":\"https://www.google.com/maps/contrib/118146636111503762478/reviews\",\"language\":\"en\",\"profile_photo_url\":\"https://lh3.googleusercontent.com/a/AItbvmncB0BWoo_9RrBEbF0gj5AGtJ-458YopD2e1DTb=s128-c0x00000000-cc-rp-mo-ba4\",\"rating\":4,\"relative_time_description\":\"a week ago\",\"text\":\"Decent food for brunch. We went with kids. Not heaps of space, but nice to have a Cafe in the area.\",\"time\":1656290021},{\"author_name\":\"Chris St Clair\",\"author_url\":\"https://www.google.com/maps/contrib/100346891358848559923/reviews\",\"language\":\"en\",\"profile_photo_url\":\"https://lh3.googleusercontent.com/a/AItbvmlMrSwzKxWL5Xpg_NKDGrnLse_9KSZ94xLM9_DW=s128-c0x00000000-cc-rp-mo-ba5\",\"rating\":5,\"relative_time_description\":\"3 months ago\",\"text\":\"Excellent  little cafe. Great friendly staff. Great coffee. Crossaint was great. Bacon and egg burger exceptional\",\"time\":1649221879},{\"author_name\":\"Manu Verma\",\"author_url\":\"https://www.google.com/maps/contrib/110603686369619340140/reviews\",\"language\":\"en\",\"profile_photo_url\":\"https://lh3.googleusercontent.com/a/AItbvmkkI3iU39_-Huyynp6U-a2a31xJh2xC7kHSJjmg=s128-c0x00000000-cc-rp-mo-ba3\",\"rating\":4,\"relative_time_description\":\"3 months ago\",\"text\":\"Go to this cafe regularly for coffee. Consistency is amazing and service is always with a smile.\nHave had breakfast/brunch few times and it was delicious.\",\"time\":1647227286}],\"types\":[\"cafe\",\"restaurant\",\"food\",\"store\",\"point_of_interest\",\"establishment\"],\"url\":\"https://maps.google.com/?cid=12121243942799526132\",\"user_ratings_total\":153,\"utc_offset\":600,\"vicinity\":\"13 Ventura Road, Northmead\",\"website\":\"https://www.facebook.com/cafeonventura/\"},\"status\":\"OK\"}";

        [Fact]
        public void ReviewIsCorrect()
        {
            var result = GooglePlaceDetailsRequest.ProcessResult(Json, out var status);

            Assert.Equal(5, result.Reviews.Count);

            var review = result.Reviews[1];
            Assert.Equal("Brendan", review.Author);
            Assert.Equal(5, review.Rating);
            Assert.Equal("Good bacon and egg roll and coffee. Roll had spinach too which was a great addition. Fast and friendly service.", review.Text);
            Assert.Equal(new DateTime(2022, 05, 16, 9, 38, 12, DateTimeKind.Utc), review.ReviewedOn);
        }

    }
}
